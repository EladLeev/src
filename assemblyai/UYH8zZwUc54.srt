1
00:01:44,670 --> 00:01:48,126
Hey, everybody, I'm Brian Kantos. I'm the chief strategy

2
00:01:48,158 --> 00:01:51,246
officer with Sevco security. And today we're talking about asset

3
00:01:51,278 --> 00:01:55,326
intelligence, dirty secrets, dangerous lies, and everyone's favorite,

4
00:01:55,438 --> 00:01:59,026
some hacking demos. So let's just jump right in. So I just

5
00:01:59,048 --> 00:02:02,686
want to give a little bit of a primer on asset intelligence, because that term

6
00:02:02,718 --> 00:02:06,434
is loaded. It means a lot of different things to a lot of different people.

7
00:02:06,552 --> 00:02:09,914
So when I talk about it, I'm really thinking about it in four

8
00:02:09,952 --> 00:02:13,174
dimensions. So the first one is length. These are your asset

9
00:02:13,222 --> 00:02:16,474
types. So this can be anything from an application,

10
00:02:16,672 --> 00:02:20,634
a vulnerability, a user, a physical device, a virtual

11
00:02:20,682 --> 00:02:23,870
machine. These can be Xiot devices,

12
00:02:24,370 --> 00:02:27,482
wireless access points, security cameras,

13
00:02:27,546 --> 00:02:31,642
voiceover, IP phones. So asset types, think of that as the length.

14
00:02:31,786 --> 00:02:35,294
Then we talk about breadth. These are the locations. So these devices can

15
00:02:35,332 --> 00:02:38,734
be on prem, they can be in the cloud, they can be at a remote

16
00:02:38,782 --> 00:02:42,942
location, they can be someone's laptop at a Starbucks, then height.

17
00:02:43,006 --> 00:02:46,326
This is where it gets really interesting. These are your asset details. And the

18
00:02:46,348 --> 00:02:50,358
best way to think about that is to bifurcate it into presence and state.

19
00:02:50,524 --> 00:02:54,294
So, for example, I might have a laptop, and on that

20
00:02:54,332 --> 00:02:57,974
laptop I have Crowdstrike, and maybe I have

21
00:02:58,012 --> 00:03:01,734
automox, Crowdstrike for EDR, automox for patch management. So that's

22
00:03:01,782 --> 00:03:05,338
presence. I know that those devices are there or those solutions are there,

23
00:03:05,504 --> 00:03:08,362
but then it comes down to state, well,

24
00:03:08,496 --> 00:03:12,238
is Crowdstrike two versions too old? Is it n minus two? Has it

25
00:03:12,244 --> 00:03:15,920
not communicated with the management console in over six months?

26
00:03:16,530 --> 00:03:20,206
Or maybe Automox is working,

27
00:03:20,308 --> 00:03:24,670
but it has an old configuration

28
00:03:24,750 --> 00:03:28,258
that's not the accepted configuration. So again, it's the state of

29
00:03:28,264 --> 00:03:31,982
those solutions, not just the present. And again, across applications

30
00:03:32,046 --> 00:03:35,618
and devices and users, and the final one is time.

31
00:03:35,784 --> 00:03:39,286
Certainly when I'm thinking about assets, I need to know real time information.

32
00:03:39,388 --> 00:03:43,142
So, for example, Bob is logged into ten one one.

33
00:03:43,276 --> 00:03:47,106
That particular machine has these particular applications, and those applications

34
00:03:47,138 --> 00:03:50,898
have these vulnerabilities. That's great. I would need that real time information,

35
00:03:51,084 --> 00:03:54,586
but I also need to know the historical data. Well, who is logged on

36
00:03:54,608 --> 00:03:57,962
to ten one one last week or last month or last

37
00:03:58,016 --> 00:04:01,386
quarter? Right. Pulling that information together so I can correlate it.

38
00:04:01,488 --> 00:04:04,746
So when I mentioned assetintelligence as part of this presentation,

39
00:04:04,938 --> 00:04:08,606
those are those four dimensions that I'm actually pointing at.

40
00:04:08,628 --> 00:04:11,934
And again, just remember, it's really any type of asset type can fall

41
00:04:11,972 --> 00:04:15,598
into that category. So let's jump into the dirty secrets.

42
00:04:15,774 --> 00:04:19,154
So, as I mentioned previously, the asset types can be any number

43
00:04:19,192 --> 00:04:23,134
of things. Well, for the sake of this presentation, we're primarily

44
00:04:23,182 --> 00:04:26,606
going to be focusing on XioT, or extended Internet

45
00:04:26,638 --> 00:04:30,006
of things. Now, there's really a few things that make

46
00:04:30,028 --> 00:04:33,254
up what I call XioT. The first one is

47
00:04:33,292 --> 00:04:36,898
this is purpose built firmware and hardware. So, for example, a printer

48
00:04:36,994 --> 00:04:41,142
isn't usually a camera, isn't usually an uninterrupted power supply,

49
00:04:41,206 --> 00:04:45,014
isn't usually a door controller. So they have a specific purpose. And the OT

50
00:04:45,062 --> 00:04:48,454
side of things, those can be very specific. It's digital assets controlling

51
00:04:48,502 --> 00:04:51,578
physics. Things like pressure, flow, temperature,

52
00:04:51,674 --> 00:04:55,146
volume. The next thing is they're network connected.

53
00:04:55,258 --> 00:04:58,382
Almost always. Not 100% of the time. And there's some

54
00:04:58,436 --> 00:05:02,666
legacy monolithic ScaDA devices that are not network connected,

55
00:05:02,698 --> 00:05:06,686
but most of them, even the old stuff today, has been retrofitted. It's actually hyperconnected.

56
00:05:06,718 --> 00:05:10,606
It's got Modbus and DNP three and TCP IP and serial over Ethernet

57
00:05:10,638 --> 00:05:11,730
and Bluetooth,

58
00:05:12,310 --> 00:05:15,794
and who knows what else are

59
00:05:15,832 --> 00:05:19,850
connected to those things. So now we're connected. So purpose built firmware hardware that's nowhere

60
00:05:19,870 --> 00:05:23,746
connected. The last item, perhaps the most important for today's

61
00:05:23,778 --> 00:05:27,190
discussion is you can't run endpoint security on these guys.

62
00:05:27,260 --> 00:05:30,934
So you're not putting an EDR, you're not putting patch management, you're not putting segmentation,

63
00:05:30,982 --> 00:05:34,442
you're not putting a local firewall or ips. The list goes on and on.

64
00:05:34,496 --> 00:05:38,266
Things that we consider pretty standard on the

65
00:05:38,288 --> 00:05:42,074
IT side of the house. You can, in many cases,

66
00:05:42,122 --> 00:05:45,374
manage the passwords. You can make sure they're being rotated every

67
00:05:45,412 --> 00:05:49,114
90 days. Follow best practices. Uppercase, lowercase, special characters,

68
00:05:49,162 --> 00:05:53,102
numbers. You can even harden them by

69
00:05:53,156 --> 00:05:56,510
shutting off certain capabilities. Maybe I don't need wireless. I just want wired.

70
00:05:56,590 --> 00:05:59,906
Maybe I don't need Bluetooth or Bluetooth, low energy ble. So I can

71
00:05:59,928 --> 00:06:04,082
shut that off. Things like that, you can make them harder in many

72
00:06:04,136 --> 00:06:07,954
cases. So that's what Xiot is in the grand scheme of asset

73
00:06:08,002 --> 00:06:11,606
intelligence. So, I'd like to throw this up here just

74
00:06:11,628 --> 00:06:14,786
because most people watching are probably pretty familiar

75
00:06:14,818 --> 00:06:18,178
with Shodan. And I did a very non scientific

76
00:06:18,354 --> 00:06:21,894
study on Shodan. I just pulled up Shodan. I typed in camera,

77
00:06:21,942 --> 00:06:25,610
voiceover, IP, printer, and ups, and what I found was pretty interesting.

78
00:06:25,680 --> 00:06:29,526
And these again, those of you who aren't familiar with Shodan,

79
00:06:29,718 --> 00:06:33,646
it's devices that are Internet accessible, that fall into certain categories and

80
00:06:33,668 --> 00:06:37,146
characteristics or regions, however you break it up. Well, if we look at camera,

81
00:06:37,178 --> 00:06:40,202
there's almost 5 million Internet accessible.

82
00:06:40,346 --> 00:06:44,778
That's important to note, because interestingly enough, most Xiot attacks

83
00:06:44,874 --> 00:06:48,478
aren't predicated on being Internet accessible. We'll get more to that in a minute.

84
00:06:48,574 --> 00:06:52,542
But almost 5 million of these cameras are voiceover

85
00:06:52,606 --> 00:06:56,446
ip phones. A little over a quarter million printers, little under 100,000.

86
00:06:56,568 --> 00:07:00,134
I was really surprised at this one ups. I thought this number would be really

87
00:07:00,172 --> 00:07:03,960
low, like almost 14,000. What's the business case

88
00:07:04,330 --> 00:07:08,130
for having an uninterrupted power supply connected

89
00:07:08,210 --> 00:07:12,250
directly to the Internet, that somebody could log in and get access to that.

90
00:07:12,320 --> 00:07:16,086
Now, what's scary about UPS systems is there's only a few flavors

91
00:07:16,118 --> 00:07:19,706
of them that are out there. And usually people buy them because they have

92
00:07:19,728 --> 00:07:23,822
something pretty important plugged into them. One of the most common ups is

93
00:07:23,876 --> 00:07:27,482
APC. And I said, well, what's the default password

94
00:07:27,546 --> 00:07:30,846
for APC UPS CSO? I use this hacking tool called Google Search.

95
00:07:30,948 --> 00:07:34,462
And I said, oh, the default username for APC ups

96
00:07:34,526 --> 00:07:38,542
is APC lowercase. And the default password is APC

97
00:07:38,686 --> 00:07:42,194
lowercase. That's it. Now, I'll tell you this, out of

98
00:07:42,232 --> 00:07:45,342
those almost 14,000 ups systems,

99
00:07:45,486 --> 00:07:48,866
again, some of them are honey

100
00:07:48,898 --> 00:07:52,280
pots or whatever, but let's just say even there's 10,000,

101
00:07:52,730 --> 00:07:56,646
the majority of those are going to be APC. And we have

102
00:07:56,668 --> 00:08:00,570
a little joke in our company. If we ever find an APC ups system

103
00:08:00,720 --> 00:08:04,262
that does not have the default APC

104
00:08:04,326 --> 00:08:07,414
APC, everybody in the company gets a steak dinner.

105
00:08:07,542 --> 00:08:11,130
Well, we've all been eating a lot of chicken because it's always

106
00:08:11,280 --> 00:08:15,022
APC APC. So that's pretty scary. What we find is there's about

107
00:08:15,076 --> 00:08:18,446
three to five XioT devices per employee. So if

108
00:08:18,468 --> 00:08:22,602
you have a company of about 10,000 people, you probably have somewhere

109
00:08:22,666 --> 00:08:26,438
between 30 to 50,000 XioT

110
00:08:26,474 --> 00:08:29,826
devices. And in most cases, when you go into an organization, you say,

111
00:08:29,848 --> 00:08:33,282
how many XioT devices do you think we have? They're almost always

112
00:08:33,336 --> 00:08:36,930
off by about 50%. So if they say, brian, I think we have 15,000,

113
00:08:37,000 --> 00:08:40,374
I'm okay. You should probably have 30,000 because they go, oh,

114
00:08:40,412 --> 00:08:43,922
we forgot about lights out management. Oh, you're counting the voiceover IP phones.

115
00:08:43,986 --> 00:08:46,758
Oh, the digital door locks. There's a lot of o.

116
00:08:46,924 --> 00:08:49,722
But at the end of the day, these are just little Linux servers. They're usually

117
00:08:49,776 --> 00:08:53,350
Ubuntu busybox. Sometimes they're Android

118
00:08:53,510 --> 00:08:57,414
network devices, a little bit of BSD. Everything else is like Android,

119
00:08:57,462 --> 00:09:00,294
Linux. Android, of course, is a derivative of Linux. But busybox,

120
00:09:00,342 --> 00:09:04,910
Ubuntu, things like that. So all that to say this, they're pretty common operating systems.

121
00:09:05,410 --> 00:09:09,086
So you've got all these Linux devices running around, you don't even know

122
00:09:09,108 --> 00:09:12,926
how many you have, and chances are they're running some kind of default username and

123
00:09:12,948 --> 00:09:17,122
password. So that's kind of a bad situation. Last statistics page.

124
00:09:17,256 --> 00:09:20,798
What we find is about 50% of all the passwords

125
00:09:20,814 --> 00:09:24,594
on XioT devices are default. And the passwords that

126
00:09:24,632 --> 00:09:27,906
were changed, most commonly they were just changed once. And that's because

127
00:09:27,928 --> 00:09:31,318
it was forced at the time of installation. We've all been there. Okay, set it

128
00:09:31,324 --> 00:09:34,326
up. You got to change the default password. It can't be password anymore. So now

129
00:09:34,348 --> 00:09:37,814
it's password one password, exclamation point, something like that.

130
00:09:38,012 --> 00:09:41,178
So think about that in terms of those stats. 10,000 people,

131
00:09:41,264 --> 00:09:45,510
50,000 devices, I've got 25,000 Linux servers

132
00:09:45,590 --> 00:09:49,322
all running the default password. And if that's not scary enough,

133
00:09:49,376 --> 00:09:53,134
and somehow the passwords were changed and are changed on

134
00:09:53,172 --> 00:09:57,102
that regular cadence, end of life firmware kicks in at about

135
00:09:57,156 --> 00:10:01,246
25%. So 26% of devices that

136
00:10:01,268 --> 00:10:04,606
we find have an end of life firmware in the XioT world.

137
00:10:04,708 --> 00:10:08,194
The remaining 74%, the average age is about six years

138
00:10:08,232 --> 00:10:11,666
old. You've all got a smartphone in your hand. Probably most of you are looking

139
00:10:11,688 --> 00:10:15,058
at it right now. Could you imagine it operating if the

140
00:10:15,064 --> 00:10:17,858
OS was six years old or the apps were six years old? It probably wouldn't

141
00:10:17,874 --> 00:10:21,954
even run. And what comes with the old firmware vulnerabilities?

142
00:10:22,082 --> 00:10:25,842
If we just look at the CVSS scores, 50% of these devices

143
00:10:25,906 --> 00:10:28,934
have level eight, but almost 70% have eight,

144
00:10:28,972 --> 00:10:32,186
nine and ten. And I know I'm preaching to the choir, but once you get

145
00:10:32,208 --> 00:10:36,630
to that level, you're talking about devices that can be exploited remotely

146
00:10:36,790 --> 00:10:40,858
with little to no effort to gain full administrative access.

147
00:10:41,024 --> 00:10:44,446
So if I can't get in through the default password, chances are I

148
00:10:44,468 --> 00:10:48,314
can probably get in through other means. So now let's talk about the dangerous

149
00:10:48,362 --> 00:10:52,046
lies. When most people think

150
00:10:52,068 --> 00:10:55,246
about XioT attacks, they think of, I'm going to

151
00:10:55,268 --> 00:10:58,706
compromise a device, a group of devices, add them to my botnet. Well, those are

152
00:10:58,728 --> 00:11:02,254
legacy attacks, and those still happen. A lot of folks have heard about Marai.

153
00:11:02,302 --> 00:11:05,966
Marai was like the grandfather of XioT attacks where cameras

154
00:11:05,998 --> 00:11:09,720
were compromised and they were added to a botnet. Well, those things still happen today.

155
00:11:10,250 --> 00:11:14,146
There's actually a really interesting attack that came out last year called RSOCs.

156
00:11:14,178 --> 00:11:17,958
It was part of a takedown, in fact. And in this case

157
00:11:18,044 --> 00:11:22,422
it was interesting because they weren't actually looking at traditional XioT.

158
00:11:22,566 --> 00:11:26,502
The phones, the printers, the cameras, they were primarily focused on OT,

159
00:11:26,646 --> 00:11:29,934
and while they did go after some network devices and they did go after some

160
00:11:29,972 --> 00:11:33,402
enterprise XIot, it was primarily

161
00:11:33,466 --> 00:11:36,926
OT by a rate of about 80%. And these are things

162
00:11:36,948 --> 00:11:41,070
like PLCs. They run real time operating systems like Vxworks,

163
00:11:41,890 --> 00:11:46,014
and they weren't attacking these OT systems in these critical

164
00:11:46,062 --> 00:11:50,158
infrastructure environments to blow up a pipeline or shut down a power grid.

165
00:11:50,254 --> 00:11:53,538
They're simply adding them to their botnet. And they

166
00:11:53,544 --> 00:11:56,526
were using this botnet to take down systems,

167
00:11:56,558 --> 00:11:59,898
as botnets do. And they were actually so successful at creating this massive

168
00:11:59,934 --> 00:12:03,346
botnet, this global botnet, it was run out of Russia, but creating

169
00:12:03,378 --> 00:12:06,326
this botnet that they were renting it out. So I think it was for like

170
00:12:06,348 --> 00:12:09,434
$25 a day, us dollars, you could rent out this

171
00:12:09,472 --> 00:12:13,702
botnet and you could do botnet stuff, DDoS attacks,

172
00:12:13,846 --> 00:12:17,350
phishing, malware distribution, black hat, search engine optimization,

173
00:12:17,430 --> 00:12:20,762
all the things that you'd like to do with the botnet. But if you pay

174
00:12:20,816 --> 00:12:24,142
like $50, you actually get all that,

175
00:12:24,196 --> 00:12:27,920
plus you get 24 x seven online support.

176
00:12:28,370 --> 00:12:31,166
So, hey, I'm not really sure how to do this. Okay, we'll give you a

177
00:12:31,188 --> 00:12:34,430
hand. So they really did turn it into sort of an attack

178
00:12:34,500 --> 00:12:38,018
as a service in this means, and it was highly, highly successful, and it

179
00:12:38,024 --> 00:12:42,270
was eventually taken down by various government agencies working collaboratively.

180
00:12:42,350 --> 00:12:45,694
But why I'd like to bring this example up is it is it's that legacy?

181
00:12:45,742 --> 00:12:48,626
Hey, you've got a device. I'm just going to add it to a botnet.

182
00:12:48,818 --> 00:12:52,294
These attacks still happen, but it's definitely not the sort of the

183
00:12:52,332 --> 00:12:55,154
big, interesting piece of Xiot attacks.

184
00:12:55,282 --> 00:12:58,486
So now let's look at physical attacks. These are things like, I'm going to

185
00:12:58,508 --> 00:13:01,334
use your camera to spy on you, and I'm going to spy on you through

186
00:13:01,372 --> 00:13:05,158
audio and video. I'm going to unlock doors. I'm going to shut down power systems.

187
00:13:05,254 --> 00:13:08,522
These are often tied to nation states, but as we know, the line

188
00:13:08,576 --> 00:13:11,898
between nation states and cybercriminals is often blurred. Right? So I'm a

189
00:13:11,904 --> 00:13:15,358
nation state hacks by day, but I might be a cybercriminal at night. And a

190
00:13:15,364 --> 00:13:19,434
great example of this was frontin. So frontin was an XioT

191
00:13:19,482 --> 00:13:22,586
hacking tool designed by contractors for the Russian

192
00:13:22,618 --> 00:13:26,010
FSB. Very, very powerful tool. I'm going to

193
00:13:26,020 --> 00:13:29,966
find XioT devices, I'm going to take control of those XioT devices,

194
00:13:30,078 --> 00:13:33,266
and then I'm going to allow you to have CNC command and control of those

195
00:13:33,288 --> 00:13:36,754
devices to do whatever type of activities you want. Well,

196
00:13:36,792 --> 00:13:40,226
unfortunately for the russian FSB, the digital revolution hacking

197
00:13:40,258 --> 00:13:44,102
group got wind of this tool, stole it, and then released it.

198
00:13:44,156 --> 00:13:47,478
And not that any of you would, but if you go onto maybe some of

199
00:13:47,484 --> 00:13:51,066
your favorite torrents, you can probably find fronten on

200
00:13:51,088 --> 00:13:54,458
those torrents. Now, if you can read Russian or you know how to

201
00:13:54,464 --> 00:13:57,626
use Google Russian to English translate, you too can

202
00:13:57,648 --> 00:14:01,606
have a nation state military grade xiot hacking

203
00:14:01,638 --> 00:14:04,974
tool as well. And again, these tools are commonly used for

204
00:14:05,012 --> 00:14:08,686
those physical type attacks that we were talking about before, but they're certainly not

205
00:14:08,708 --> 00:14:12,186
limited to that. Another type of attack are OEm attacks.

206
00:14:12,298 --> 00:14:16,062
Now, these are attacks that it's not malware,

207
00:14:16,126 --> 00:14:19,474
they just ship maliciously out of the box. CSO, I'm talking about

208
00:14:19,512 --> 00:14:23,730
products like Huawei, ZTE, Hickvision, and there's several others.

209
00:14:23,880 --> 00:14:26,974
But these, in fact, are cameras. In most cases,

210
00:14:27,022 --> 00:14:31,110
they're cameras that came out of China. In most cases that

211
00:14:31,180 --> 00:14:34,518
if they're recording audio and video and you say, hey, stop recording audio and

212
00:14:34,524 --> 00:14:38,274
video, it turns the green light to red. But guess what? It's still recording

213
00:14:38,322 --> 00:14:42,186
audio. It's still recording video. Even worse, it's streaming that

214
00:14:42,208 --> 00:14:45,702
information. Now, a lot of security cameras are in very sensitive locations,

215
00:14:45,766 --> 00:14:49,206
as you can imagine. They're in military locations, they're industrial

216
00:14:49,238 --> 00:14:52,966
manufacturing, they're in healthcare, they're in pharmaceutical, they're in conference

217
00:14:52,998 --> 00:14:56,526
rooms. And all these other locations around CSO, if you have this massive stream of

218
00:14:56,548 --> 00:15:00,170
data, chances are you're probably going to find something sensitive somewhere.

219
00:15:00,330 --> 00:15:03,474
Now, for a while, we've known about this in a while, I'll say a few

220
00:15:03,512 --> 00:15:07,234
years. And it was policy within

221
00:15:07,272 --> 00:15:11,074
the US government that us government agencies and contractors were

222
00:15:11,112 --> 00:15:15,382
told not to use these cameras, that they're naughty cameras, don't install them.

223
00:15:15,516 --> 00:15:18,600
Well, in 2022, November of 2022,

224
00:15:19,290 --> 00:15:23,142
it's now illegal to import or

225
00:15:23,196 --> 00:15:26,758
sell these cameras within the United States.

226
00:15:26,924 --> 00:15:29,946
So most people, when that happened, went out on eBay and grabbed up as many

227
00:15:29,968 --> 00:15:33,514
as they could for their hacking labs. But the fact is

228
00:15:33,552 --> 00:15:36,922
that these cameras, while illegal to sell

229
00:15:36,976 --> 00:15:40,314
and use with the United States, are everywhere. In fact,

230
00:15:40,352 --> 00:15:43,634
I was at a conference in Dubai called Jitech.

231
00:15:43,702 --> 00:15:47,214
Great conference. It's kind of like ten black hats all

232
00:15:47,252 --> 00:15:50,366
glued together mixed with, like, RSA. So it's a huge,

233
00:15:50,388 --> 00:15:54,146
huge conference, like 150,000 plus people. Anyhow, one of the

234
00:15:54,168 --> 00:15:57,986
biggest sponsors there was Hickvision. I mean, you actually physically had

235
00:15:58,008 --> 00:16:01,346
to walk through their inflatable sign to get into

236
00:16:01,368 --> 00:16:05,022
the event. And just because they're still used worldwide,

237
00:16:05,086 --> 00:16:07,620
they're still very, very common.

238
00:16:08,470 --> 00:16:11,874
And the last type of attack that I want to talk about are pivot attacks.

239
00:16:12,002 --> 00:16:15,494
This is gaining access to your environment via one mechanism and then

240
00:16:15,532 --> 00:16:19,126
using Xiot on the backend. And a popular example of this is

241
00:16:19,148 --> 00:16:23,066
called Quiet Exit. This was actually an attack that was discovered by Mandian about

242
00:16:23,088 --> 00:16:25,706
a year and a half ago, maybe a little bit more than a year and

243
00:16:25,728 --> 00:16:29,446
a half, and pretty straightforward if you think about it. So what's

244
00:16:29,478 --> 00:16:32,606
one of the best ways to get into our organization? A phishing attack.

245
00:16:32,708 --> 00:16:36,782
So either through social media or some type of messaging app

246
00:16:36,916 --> 00:16:40,046
or an email, they get somebody to click, and we all

247
00:16:40,068 --> 00:16:43,246
know it works. So you basically just get this out to as many

248
00:16:43,268 --> 00:16:47,346
people you can in the organization. Someone, sometime, somewhere is

249
00:16:47,368 --> 00:16:51,470
going to click on it and get infected. Well, let's say their laptop gets infected.

250
00:16:51,630 --> 00:16:55,170
Well, the bad guys are like, well, hey, you've got network security and data secrets

251
00:16:55,240 --> 00:16:58,570
and application security and segmentation and this and that. I don't want to hang

252
00:16:58,590 --> 00:17:02,246
out here. I want to maintain persistence and I also

253
00:17:02,268 --> 00:17:05,446
want to evade detection. So what they do? Well, as soon as they

254
00:17:05,468 --> 00:17:09,174
got on, on that laptop and they had control, they started looking

255
00:17:09,372 --> 00:17:12,460
for XioT devices. In this particular case,

256
00:17:12,910 --> 00:17:16,234
in the case of quiet exit, they were looking for a lot of network based

257
00:17:16,272 --> 00:17:20,354
devices, which we talked about before, are things that are running BSD,

258
00:17:20,502 --> 00:17:23,466
wireless access points, load balancers,

259
00:17:23,578 --> 00:17:27,262
switches, network attached storage. Right? We've all got these

260
00:17:27,316 --> 00:17:31,098
all over our environments. Well, in addition to that, they also added

261
00:17:31,114 --> 00:17:35,410
some XioT stuff, traditional stuff, the voiceover, IP phones,

262
00:17:35,750 --> 00:17:39,474
the security cameras, the printers, things of that nature. And once

263
00:17:39,512 --> 00:17:42,974
they found these devices, they had their own version of Dropbear

264
00:17:43,022 --> 00:17:46,346
SSH, which as most of you know, is a client server software

265
00:17:46,398 --> 00:17:49,970
that you can use to have command and control and can do reverse tunnels.

266
00:17:50,050 --> 00:17:53,510
Okay, so that's pretty interesting. So they actually built

267
00:17:53,580 --> 00:17:57,462
this variant of dropbear SsH to run on these

268
00:17:57,596 --> 00:18:01,106
Linux, Android and BSD frameworks

269
00:18:01,218 --> 00:18:04,250
that they installed. So, okay, I got in through a laptop.

270
00:18:04,830 --> 00:18:08,314
I'm going to look for a vulnerable Xiot device that I know probably most people

271
00:18:08,352 --> 00:18:12,438
aren't managing. And I'm going to install there and I'm

272
00:18:12,454 --> 00:18:16,218
going to install there easily because the password is probably the default password

273
00:18:16,314 --> 00:18:20,282
and God forbid somebody changed it. I know you haven't updated the firmware,

274
00:18:20,426 --> 00:18:23,534
it's not patch. So I'm just going to find one of the level eight,

275
00:18:23,572 --> 00:18:27,186
nine or ten vulnerabilities of the 50 that that device is probably running and

276
00:18:27,208 --> 00:18:30,546
has been running for the last decade. Okay, so it's easy to get

277
00:18:30,568 --> 00:18:34,574
onto these devices, but the other thing is remember back to our statistic earlier,

278
00:18:34,702 --> 00:18:38,626
three to five devices per employee. If I'm on a laptop and I

279
00:18:38,648 --> 00:18:42,038
get on a network attached storage device and I get on a camera, am I

280
00:18:42,044 --> 00:18:45,526
just going to stop at those two devices? If it's an organization I really

281
00:18:45,548 --> 00:18:49,302
care about and I truly want to maintain persistence, why install in two

282
00:18:49,356 --> 00:18:52,858
if I can install in 200 or 2000 or 20,000?

283
00:18:53,024 --> 00:18:56,202
So now they're installed on all these devices, a plethora, throughout the entire

284
00:18:56,256 --> 00:18:59,434
environment. They get to the next phase of the attack, which is very simple.

285
00:18:59,472 --> 00:19:02,906
They're making API calls to on Prem, in this case, a quiet exit

286
00:19:03,018 --> 00:19:06,522
to office 365 and local exchange.

287
00:19:06,586 --> 00:19:10,346
So in the cloud and on prem mail, and they're pulling

288
00:19:10,378 --> 00:19:13,774
down all the information. They're mostly targeting biz dev

289
00:19:13,812 --> 00:19:17,522
people, people in finance and organizations that might have to do with M and A.

290
00:19:17,656 --> 00:19:21,086
And they're also watching the security team messages as well, to see if anyone's

291
00:19:21,118 --> 00:19:25,074
getting any wind of what they're doing. And they exfiltrated this data out.

292
00:19:25,272 --> 00:19:28,626
So, pretty straightforward attack. A little bit novel in the

293
00:19:28,648 --> 00:19:31,554
approach that they used with the XioT devices, at least Historically.

294
00:19:31,602 --> 00:19:34,994
Novel, not novel anymore. In most cases,

295
00:19:35,042 --> 00:19:37,906
though, people didn't even realize that they had been compromised.

296
00:19:38,018 --> 00:19:41,414
So there was a threat window of 18 to 24 months,

297
00:19:41,612 --> 00:19:44,874
CSO, 18 to 24 months, let's say two years before you figure

298
00:19:44,912 --> 00:19:48,314
out that this is even happening. Now you have to go back and clean

299
00:19:48,352 --> 00:19:52,070
up the mess on 20,000 Xiot devices

300
00:19:52,230 --> 00:19:55,758
that you didn't even know you had to begin with. Now you

301
00:19:55,764 --> 00:19:59,470
got to figure out who's managing it, what kind of security?

302
00:19:59,620 --> 00:20:02,158
Can we update these things? How do we do it? Is it one at a

303
00:20:02,164 --> 00:20:05,538
time? It's a real mess. And honestly, it's like

304
00:20:05,704 --> 00:20:09,166
the end of Spiderman, the Spiderverse. Everyone's pointing at each other. It's like, who runs

305
00:20:09,198 --> 00:20:13,054
this? Who's responsible security? No, it's network operations,

306
00:20:13,182 --> 00:20:17,018
not us. It's physical security. They've got it. No, we outsource

307
00:20:17,054 --> 00:20:20,694
that. It's a cluster and the bad guys know

308
00:20:20,732 --> 00:20:24,818
it, which is why they're targeting it, which is why attacks like Quietexit

309
00:20:24,914 --> 00:20:27,858
are so successful. Quite honestly, pretty darn scary.

310
00:20:28,034 --> 00:20:32,006
So let's get into some examples of this. I've got two really fun examples just

311
00:20:32,028 --> 00:20:34,906
to show you. One on the OT side, because I don't think a lot of

312
00:20:34,928 --> 00:20:38,378
people get exposure to see how that works, and one that is on

313
00:20:38,464 --> 00:20:41,702
the traditional Xiot side. So for the Xiot,

314
00:20:41,766 --> 00:20:44,942
we're just going to take a look at a security camera, everyone's got them,

315
00:20:45,076 --> 00:20:48,446
they're all over the place and honestly they're quite easy to compromise. And let's see

316
00:20:48,468 --> 00:20:51,226
how we're going to do it. So this is just Kali Linux,

317
00:20:51,418 --> 00:20:54,654
nothing too fancy. Most of you are familiar with this, a great platform to use

318
00:20:54,692 --> 00:20:58,660
for exploitation. And I'm going to log into a camera. This part,

319
00:20:59,510 --> 00:21:02,466
there's no hacking being done. I'm just going to show you what this camera is.

320
00:21:02,488 --> 00:21:05,838
I'm going to log in as an admin, type in my password,

321
00:21:06,014 --> 00:21:09,554
and as we log in you can do the typical things that you'd expect

322
00:21:09,592 --> 00:21:12,562
to be able to do if you logged into the camera.

323
00:21:12,706 --> 00:21:15,958
Well the first thing that we can do that's pretty straightforward is see what the

324
00:21:15,964 --> 00:21:19,998
camera sees. Well this camera is looking at another camera, a hick vision camera sitting

325
00:21:20,034 --> 00:21:23,418
on a switch. So that's super interesting, but we can also look at

326
00:21:23,424 --> 00:21:26,742
the configuration and we can see the network configuration.

327
00:21:26,806 --> 00:21:30,582
We've got the IP address, a default gateway, all the typical

328
00:21:30,646 --> 00:21:34,598
things that we'd want to see with a camera. So again, nothing fancy. Just wanted

329
00:21:34,624 --> 00:21:37,438
to show you that we've got a camera running in our environment. We're going to

330
00:21:37,444 --> 00:21:41,194
connect it with Kali. So I'm going to run showdown

331
00:21:41,322 --> 00:21:44,398
just to do a little query here and I'm going to see how many of

332
00:21:44,404 --> 00:21:46,898
these particular cameras. I'm going to put the last string at the end of the

333
00:21:46,904 --> 00:21:50,146
URL in that search. It goes oh, okay, so there's about three and a

334
00:21:50,168 --> 00:21:53,358
half million of these cameras worldwide.

335
00:21:53,454 --> 00:21:56,818
If we just look in the US, we find out there's a little under a

336
00:21:56,824 --> 00:21:59,974
half a million. So this particular camera type that we're looking at

337
00:22:00,012 --> 00:22:03,654
right now at the point I did this example, about a half a million

338
00:22:03,692 --> 00:22:06,918
that are Internet accessible. Well based on that camera type I'm going to

339
00:22:06,924 --> 00:22:10,220
go to exploit database and you could go to whatever

340
00:22:10,750 --> 00:22:14,474
your flavor that you like for your databases. You can go on the dark web

341
00:22:14,512 --> 00:22:18,790
and buy attacks, whatever, this is free, it's publicly accessible. So exploit

342
00:22:18,870 --> 00:22:22,106
DB, I say, okay, this is the camera I have. Let me look up the

343
00:22:22,128 --> 00:22:25,694
CVE. Here's the attack. This is

344
00:22:25,732 --> 00:22:29,166
great. It's a command injection attack. I can go ahead and grab that and

345
00:22:29,188 --> 00:22:32,926
modify it or I can just go ahead and download it directly. So I

346
00:22:32,948 --> 00:22:36,634
found out what the camera is. I download the exploit, I'm going to create Operation

347
00:22:36,682 --> 00:22:40,146
Hickvision. I'm going to run the python script with check and

348
00:22:40,168 --> 00:22:43,394
it says sure enough, this camera is vulnerable to this

349
00:22:43,432 --> 00:22:46,798
exploit. Fantastic. Now I'm going to change this python script

350
00:22:46,814 --> 00:22:50,626
from check to shell and boom, I'm in full administrative

351
00:22:50,658 --> 00:22:53,798
access. I see that it's running busybox. It was that simple.

352
00:22:53,884 --> 00:22:57,080
And now I'm even deeper than had I been if I logged in

353
00:22:58,170 --> 00:23:01,786
via the GUI, right? Because I'm underneath the GUi interface, I'm able to do

354
00:23:01,808 --> 00:23:05,354
everything as root on the system. So now I'm just listing some

355
00:23:05,392 --> 00:23:09,078
files. I see that I created a file. So I'm on this busy

356
00:23:09,094 --> 00:23:12,090
box. I created a file, or a folder rather, called bad.

357
00:23:12,240 --> 00:23:15,774
Okay, that's interesting. So what else can we do? Let's just clear

358
00:23:15,812 --> 00:23:18,206
this up a little bit. We'll re access it a couple of times just to

359
00:23:18,228 --> 00:23:21,760
make this screen easy to read. So what else can we do here?

360
00:23:22,770 --> 00:23:25,450
Let's first go to bad. So we'll go to this directory. Now I'm going to

361
00:23:25,460 --> 00:23:29,086
run TFTP. I'm going to do a remote get of a file

362
00:23:29,118 --> 00:23:32,402
called do bad off my Kali Linux system, right?

363
00:23:32,456 --> 00:23:35,902
So now I'm saying, hey, I'm running a TFTP server on Kali Linux.

364
00:23:35,966 --> 00:23:39,646
I'm going to run TFTP from the camera to Kali Linux on the default

365
00:23:39,678 --> 00:23:43,330
port 69 to get the file called do bad. So can I download

366
00:23:43,410 --> 00:23:46,626
files directly to the camera? Sure enough, there it is. I do a listing.

367
00:23:46,658 --> 00:23:50,154
There's do bad. I'm going to make it so everybody can read, write, execute that

368
00:23:50,192 --> 00:23:53,946
file. There it is, do bad. And let's see what

369
00:23:53,968 --> 00:23:57,530
do bad is. So essentially we went through this to download what,

370
00:23:57,680 --> 00:24:01,498
a shrek video? Because science, why not?

371
00:24:01,584 --> 00:24:04,794
And we could download scanners, password crackers, we cloud download

372
00:24:04,842 --> 00:24:08,526
things to do crypto mining, which is very common on cameras. Again, just a little

373
00:24:08,548 --> 00:24:12,074
Linux server. Okay, so we're able to upload

374
00:24:12,122 --> 00:24:15,258
files. What else can we do? So I'm going to go in the config file

375
00:24:15,354 --> 00:24:19,550
of this camera and see if I can find anything interesting. Well, here's serversert

376
00:24:19,630 --> 00:24:23,426
pem, as most of you know, these are tied to your certificates that

377
00:24:23,448 --> 00:24:26,894
you're using. So I'm going to use SCp now. So ssh port 22,

378
00:24:26,952 --> 00:24:30,434
so secure copy protocol. I'm going to grab all the PEM files.

379
00:24:30,562 --> 00:24:34,306
I'm going to exfiltrate that again to my Kali Linux

380
00:24:34,338 --> 00:24:37,670
server. The same system that was running TFTp

381
00:24:38,090 --> 00:24:41,366
is also running ssh. So I'm going to ssh and I'm going

382
00:24:41,388 --> 00:24:44,966
to basically grab those two files. Now I could have downloaded tools

383
00:24:44,998 --> 00:24:48,154
that were going to enumerate the network and grab other people's files and then

384
00:24:48,192 --> 00:24:51,626
take those files down. Compress them and expel. It would take too

385
00:24:51,648 --> 00:24:55,134
long, but you get the picture. And now I was able to grab files off

386
00:24:55,172 --> 00:24:59,182
the camera and bring them onto my Kali Linux system. It was that simple.

387
00:24:59,316 --> 00:25:02,654
So hacking. So pretty much we

388
00:25:02,692 --> 00:25:05,694
found out that the camera was what kind of camera it was.

389
00:25:05,892 --> 00:25:09,486
We went on exploit DB, one of lots of places

390
00:25:09,518 --> 00:25:12,926
to grab exploits. We downloaded it. We didn't even use metasploit.

391
00:25:12,958 --> 00:25:16,434
We just executed the Python script, which gave us full

392
00:25:16,472 --> 00:25:19,718
access to the system by exploiting that vulnerability. In this case, I think it was

393
00:25:19,724 --> 00:25:23,750
a level nine vulnerability, but it exploits that vulnerability, and now we've got direct

394
00:25:23,820 --> 00:25:27,522
access, upload files, download files, change configurations.

395
00:25:27,586 --> 00:25:30,726
If we wanted to, we can spy on people through the camera, et cetera,

396
00:25:30,758 --> 00:25:33,740
et cetera. So very, very straightforward attack.

397
00:25:34,510 --> 00:25:37,718
The next one and last one I want to show you is hacking industrial robots.

398
00:25:37,814 --> 00:25:41,098
And this one's a lot of fun. And one thing I'll mention, too,

399
00:25:41,184 --> 00:25:45,034
about any type of OT ScADA critical infrastructure

400
00:25:45,082 --> 00:25:48,746
device, however you'd like to categorize it, yes, you can do malicious

401
00:25:48,778 --> 00:25:53,162
things to the device. That's certainly one type of attack. But the intellectual

402
00:25:53,226 --> 00:25:57,314
property that organizations have in terms of how I make a certain

403
00:25:57,352 --> 00:26:00,862
pharmaceutical drug, what temperature and how much ultraviolet

404
00:26:00,926 --> 00:26:04,574
light and how much I stir for how long, at what speed,

405
00:26:04,702 --> 00:26:07,766
that IP isn't kept in some file system or some

406
00:26:07,788 --> 00:26:11,554
database. It's stored within those devices, whether it's batch

407
00:26:11,602 --> 00:26:15,410
manufacturing, discrete manufacturing, whatever it is, how I make Volvo's

408
00:26:15,490 --> 00:26:18,646
or how I make a painkiller that's kept on

409
00:26:18,668 --> 00:26:21,718
these devices. So if you can get access to these devices, you can actually steal

410
00:26:21,734 --> 00:26:25,494
the intellectual property. So this is a Fanook robot.

411
00:26:25,542 --> 00:26:29,002
These robots are really common. You see them in pretty much every

412
00:26:29,056 --> 00:26:32,842
single industry, and they're really fun to play with. So we bought a

413
00:26:32,896 --> 00:26:36,558
brand new Fanook, shipped in a crate that we actually ended up mounting the

414
00:26:36,564 --> 00:26:39,662
robot to that we did not do a very good job covering it up

415
00:26:39,796 --> 00:26:43,850
with these blankets. And we did the latest, greatest software,

416
00:26:44,010 --> 00:26:47,274
the firmware, all the latest patches,

417
00:26:47,402 --> 00:26:50,302
as vanilla as it could be. We wanted to be on the latest version,

418
00:26:50,366 --> 00:26:53,906
but with no modifications, just kind of how you'd get it out

419
00:26:53,928 --> 00:26:58,238
of the box. So these boxes are pretty cool. So here's

420
00:26:58,254 --> 00:27:01,462
a little bit of hacking on this Fanook. Now that you can control

421
00:27:01,516 --> 00:27:04,598
these guys a few ways, of course. Here's our remote control.

422
00:27:04,764 --> 00:27:08,760
And being the people we are, we said, well, let's just write

423
00:27:09,850 --> 00:27:12,946
some logic that will actually have this robot

424
00:27:13,058 --> 00:27:16,474
touch the top of a coke can very gently, because it'd be easy

425
00:27:16,512 --> 00:27:19,226
to do other things. We said, can we be gentle with it? Can we just

426
00:27:19,248 --> 00:27:22,574
touch the top of the coke can and come down again?

427
00:27:22,612 --> 00:27:26,378
I can use that using the physical remote control that's actually physically wired

428
00:27:26,474 --> 00:27:29,882
to the fanook. And you'll hear it pronounced Fanuc and Fanook.

429
00:27:30,026 --> 00:27:33,758
It's used interchangeably. So that's one way I can control it with this and

430
00:27:33,764 --> 00:27:36,578
program it. The other way is plc. So up here on this rack we've got

431
00:27:36,584 --> 00:27:40,178
a Rockwell and a Siemens. I can actually use that to control

432
00:27:40,264 --> 00:27:43,426
it. The third way is it's connected to

433
00:27:43,448 --> 00:27:47,342
the network, so I can ping it. I can ping my robot.

434
00:27:47,486 --> 00:27:50,006
If I can ping it, what else can I do? Okay, this is on the

435
00:27:50,028 --> 00:27:52,690
network again, this is an out of the box installation.

436
00:27:52,850 --> 00:27:56,614
So let me just put its ip address in a browser and see what

437
00:27:56,652 --> 00:28:00,094
happens. Boom, it's running a little web server

438
00:28:00,242 --> 00:28:03,386
from 1993, but it's a little web

439
00:28:03,408 --> 00:28:07,050
server. It's not the prettiest interface, but hey, it works for what it's doing.

440
00:28:07,200 --> 00:28:10,566
Okay, what can we learn by logging into the web server

441
00:28:10,598 --> 00:28:13,770
running on this robot with absolutely no security?

442
00:28:13,920 --> 00:28:17,230
Right? There was no authentication, nothing was done. Here we see the version. Okay,

443
00:28:17,300 --> 00:28:20,878
this was installed in January 2023. We see some of

444
00:28:20,884 --> 00:28:24,958
the configuration specs. Okay, that's interesting. That's valuable information to know

445
00:28:25,044 --> 00:28:28,258
for sure. Oh, active programs. Let's look at

446
00:28:28,264 --> 00:28:31,698
those active programs. Okay. It's in binary and ASCII. Well, I don't

447
00:28:31,704 --> 00:28:35,006
want to look at the binary. Show me canls. There's that ip

448
00:28:35,038 --> 00:28:38,802
we just talked about. So that program where the robot arm came down,

449
00:28:38,856 --> 00:28:42,166
just tapped the top of the can. There it is. We're going to play with

450
00:28:42,188 --> 00:28:45,266
this one a little bit later. So we can actually see the IP,

451
00:28:45,378 --> 00:28:49,254
the program that this robot was running. So that's not great right

452
00:28:49,292 --> 00:28:52,314
off the bat that we can get on with no access control at all.

453
00:28:52,432 --> 00:28:55,926
Now, that pendant that we are holding in our hand, that physical controller,

454
00:28:56,038 --> 00:28:59,466
there's a virtual version, the I pendant, right? So it's just

455
00:28:59,488 --> 00:29:02,446
like you're holding it, but we can do it virtually. So let's look at some

456
00:29:02,468 --> 00:29:05,934
of the settings here. Well, the first thing we see is,

457
00:29:06,132 --> 00:29:09,054
okay, it's got some TCP IP information. Great,

458
00:29:09,092 --> 00:29:12,190
we're already connected. We got that. But it's running FTP.

459
00:29:12,690 --> 00:29:16,014
Okay, anonymous FTP. Yikes.

460
00:29:16,142 --> 00:29:19,218
That can't be right, can it? So let's find out.

461
00:29:19,304 --> 00:29:22,814
Let's publicly google it and find out what Fanuk says about FTP.

462
00:29:22,942 --> 00:29:26,526
I love this line here. If you see an anonymous username.

463
00:29:26,638 --> 00:29:29,780
You may be able to connect through FTP without.

464
00:29:30,470 --> 00:29:34,134
Huh, you don't say. Interesting. Well, let's see

465
00:29:34,172 --> 00:29:37,782
what we can do. So let's go ahead and try to

466
00:29:37,836 --> 00:29:41,122
FTP to this IP address. And it must be a typo.

467
00:29:41,186 --> 00:29:44,442
There's no way this would be anonymous access right out of the box.

468
00:29:44,496 --> 00:29:47,754
And I'd be like, oh my God, I can. So now I can

469
00:29:47,792 --> 00:29:51,338
FTP to this device. Well, there's probably not much we can do. Let's see if

470
00:29:51,344 --> 00:29:54,794
we can do a directory listing. And within these guys, it's all

471
00:29:54,832 --> 00:29:58,614
flat. There's no folders, there's no hierarchy. So it's a big flat file

472
00:29:58,662 --> 00:30:02,418
system of all the files. Remember that can ls file we

473
00:30:02,424 --> 00:30:05,666
looked at before where we showed the intellectual property? Well, there it is.

474
00:30:05,688 --> 00:30:09,006
So we can see that file there. Okay, Brian, big deal. You can FTP,

475
00:30:09,038 --> 00:30:11,058
but there's no way you can get a file, right? You're not going to be

476
00:30:11,064 --> 00:30:14,386
able to download it. Oh my God, we did. So it's actually able

477
00:30:14,488 --> 00:30:17,518
to download that can ls file the IP.

478
00:30:17,614 --> 00:30:21,126
So I got it off the device again. Now it's on my laptop. I've got

479
00:30:21,148 --> 00:30:25,286
a little windows laptop here. I use my hacker tool notepad and

480
00:30:25,308 --> 00:30:28,614
I open it up. There's the program called can. I'm going to change the name

481
00:30:28,652 --> 00:30:32,506
to can crush and I'm going to change one variable here from a two to

482
00:30:32,528 --> 00:30:36,806
a three from 205

483
00:30:36,918 --> 00:30:40,086
on the z axis. It's the only change I made besides changing

484
00:30:40,118 --> 00:30:43,486
the program name. Now I'm going to save this and I have

485
00:30:43,508 --> 00:30:47,066
to change it to ls because that's the extension that expects

486
00:30:47,098 --> 00:30:51,630
to see. So I'm going to do cancrush ls save

487
00:30:51,780 --> 00:30:55,438
again. I'm just doing this on my windows machine. This isn't on the robot yet.

488
00:30:55,604 --> 00:30:59,006
Okay, so we know we could FTP in, we could download a file,

489
00:30:59,038 --> 00:31:02,526
but there's no way we're going to be able to upload a file via anonymous

490
00:31:02,558 --> 00:31:05,878
ft. Oh my God, we can. So there it is.

491
00:31:06,044 --> 00:31:09,718
So we actually uploaded the file. And here's all the

492
00:31:09,804 --> 00:31:12,946
ls files. And there's canls, the original,

493
00:31:13,058 --> 00:31:16,486
and then there's cancrush, the naughty, naughty one we made.

494
00:31:16,668 --> 00:31:20,166
We modified the z axis. Okay, so we know we

495
00:31:20,188 --> 00:31:24,102
can get access via FTP. We know we can download

496
00:31:24,166 --> 00:31:27,962
files. We know we can modify those files and we know we can upload them.

497
00:31:28,016 --> 00:31:31,494
And here it is. Here's the cancrush ls

498
00:31:31,542 --> 00:31:35,006
file in ASCII that we wanted to take a look at. We see

499
00:31:35,028 --> 00:31:38,190
where it was modified and there's that z axis.

500
00:31:38,770 --> 00:31:42,640
So we changed it to 305 instead of 205. So pretty cool.

501
00:31:43,010 --> 00:31:46,622
But there's a couple of things we need to do because these robots

502
00:31:46,686 --> 00:31:49,858
are rebooted pretty frequently to clear the cache. When I

503
00:31:49,864 --> 00:31:52,980
say frequently, every couple of weeks and they reboot really fast,

504
00:31:53,510 --> 00:31:56,974
it usually takes like 10 seconds or less. But I want to find the default

505
00:31:57,022 --> 00:32:00,406
program to make sure that every time it reboots it uses it. So even if

506
00:32:00,428 --> 00:32:02,774
you don't know what it's called, you can probably guess.

507
00:32:02,972 --> 00:32:06,646
Default prog is the default program. We're going to change

508
00:32:06,668 --> 00:32:10,006
it from can to can crush now. You can reboot this

509
00:32:10,028 --> 00:32:13,766
thing all day, all night. It's always going to come up with can crush

510
00:32:13,798 --> 00:32:17,306
now because that's a default program. And again, they're rebooted a lot. So you want

511
00:32:17,328 --> 00:32:20,566
to make sure that if you're making a modification, you add it to the default

512
00:32:20,598 --> 00:32:23,706
program. Let's focus on what a reboot looks

513
00:32:23,728 --> 00:32:26,506
like, just so you can see it. There's lots of blinky lights. There's an Alan

514
00:32:26,538 --> 00:32:30,222
Bradley behind it as well, which is another PlC. But here we go.

515
00:32:30,276 --> 00:32:33,886
That's a very quick reboot. It doesn't say,

516
00:32:33,908 --> 00:32:37,362
hey, you just loaded a new naughty naughty file. So now

517
00:32:37,416 --> 00:32:40,898
we're expecting our robot to continue to do what it was doing,

518
00:32:40,984 --> 00:32:45,106
which is just do a nice little, nice little tap on top of that

519
00:32:45,128 --> 00:32:49,042
coke can and nothing worse. Oh my gosh. So it's actually

520
00:32:49,096 --> 00:32:52,534
running the can crush file. We had a little fun shooting this from different

521
00:32:52,572 --> 00:32:55,574
angles. And then we actually made the robot dance, which was pretty fun.

522
00:32:55,612 --> 00:32:58,518
And we made it do push ups, which isn't in the video, but was a

523
00:32:58,524 --> 00:33:02,450
lot of fun. So again, the fact that one

524
00:33:02,540 --> 00:33:05,818
there was no authentication turned on by default, that's an issue. And it's not

525
00:33:05,824 --> 00:33:09,546
to go after these guys at fenuc. This is the case across

526
00:33:09,648 --> 00:33:13,022
these ot devices. It's all about capital a. When you think about

527
00:33:13,076 --> 00:33:16,746
CIA confidentiality, integrity, availability, it's all about availability.

528
00:33:16,858 --> 00:33:20,414
So they often ship with no security controls, no authentication. The problem

529
00:33:20,452 --> 00:33:24,394
is they're plugged into the network, they're running web servers, they're running FTP servers,

530
00:33:24,442 --> 00:33:27,678
they've got email, they've got all these other things enabled in them. So it's

531
00:33:27,694 --> 00:33:31,154
very easy to get that intellectual property and with very

532
00:33:31,272 --> 00:33:34,626
basic skills. None of us were experts in this robot at

533
00:33:34,648 --> 00:33:37,730
all. We kind of just found out how to do these things through the online

534
00:33:37,800 --> 00:33:40,726
documentation. Oh, what file does it read?

535
00:33:40,828 --> 00:33:44,230
What format can we modify that in notepad and update it.

536
00:33:44,300 --> 00:33:47,366
Okay. If we put it in the default program when we reboot, will it really

537
00:33:47,388 --> 00:33:50,850
stay there or. There are eight other switches we have to hit. Pretty straightforward.

538
00:33:50,930 --> 00:33:54,650
Didn't take a ton of expertise, but very valuable. And this one was quite obvious,

539
00:33:54,720 --> 00:33:58,214
right? It went from touching a can to crushing a can, someone's going to notice

540
00:33:58,262 --> 00:34:01,662
that. But think if someone's manufacturing a car,

541
00:34:01,716 --> 00:34:06,138
for example, and a gear was supposed to be four and a half millimeters thick,

542
00:34:06,234 --> 00:34:10,682
but they made it 4.52 mm

543
00:34:10,746 --> 00:34:14,094
thick, well, it's probably going to pass QA, it's probably

544
00:34:14,132 --> 00:34:17,502
going to work. It's probably going to work for the first couple of months or

545
00:34:17,556 --> 00:34:20,446
even a couple of quarters, but eventually it's going to create so much friction,

546
00:34:20,558 --> 00:34:23,966
something's going to break, something's going to snap, it's going to cause a problem depending

547
00:34:23,998 --> 00:34:27,566
on where it is in the vehicle. And now you have a whole supply

548
00:34:27,598 --> 00:34:31,318
chain issue of devices that you've released that's a car. What if it's a

549
00:34:31,324 --> 00:34:34,706
tank? Or what if it's something else? So they can be very sensitive, in addition

550
00:34:34,738 --> 00:34:37,762
to the fact that we could download that intellectual property and steal it and leverage

551
00:34:37,826 --> 00:34:41,226
it. So I never like to just show the

552
00:34:41,248 --> 00:34:44,810
offensive side with that just a little bit. On remediation,

553
00:34:45,630 --> 00:34:48,822
I talked about asset intelligence at the very beginning and the four dimensions

554
00:34:48,886 --> 00:34:52,782
of Asset intel. And there's solutions out there today called

555
00:34:52,836 --> 00:34:56,138
asset intelligence platforms. And whether you've got robots,

556
00:34:56,314 --> 00:35:00,538
or you've got endpoint security devices, and it's installed

557
00:35:00,554 --> 00:35:03,986
on laptops, or you've got cloud, or you've got identities or vulnerability information, you've got

558
00:35:04,008 --> 00:35:07,746
all these sources of asset information, and they go through

559
00:35:07,768 --> 00:35:11,570
these different silos to your vulnerability management solutions, like tenable cloud

560
00:35:11,640 --> 00:35:15,646
infrastructure, like Google Cloud, IoT, OT, like phosphorus, or endpoint,

561
00:35:15,678 --> 00:35:19,154
like CrowdStrike, and they feed into these, these asset intelligent

562
00:35:19,202 --> 00:35:23,014
platforms that they're cloud native, they're agentless, they're very

563
00:35:23,052 --> 00:35:26,546
easy to work with, they'll make API calls to these different management

564
00:35:26,578 --> 00:35:29,750
consoles. So you kind of get the state of, the state of all your assets,

565
00:35:29,830 --> 00:35:33,366
including all those Xiot assets. Right. The focus of today's

566
00:35:33,398 --> 00:35:36,902
presentation was Xiot, but this expands to all of your asset types.

567
00:35:36,966 --> 00:35:40,106
Xiot is just fun to hack. So now you

568
00:35:40,128 --> 00:35:43,582
can have a platform that looks at all your asset intelligence, a lot like SIM

569
00:35:43,636 --> 00:35:47,226
looks at log data and event information correlates, that lets

570
00:35:47,258 --> 00:35:50,926
you analyze it, lets you sort things to say, again, presence and

571
00:35:50,948 --> 00:35:54,826
state. Hey, CrowdStrike is installed on 500 devices,

572
00:35:54,938 --> 00:35:58,862
but according to what I have in Microsoft active directory, I've got 600 devices

573
00:35:58,926 --> 00:36:02,580
that can be and should be running Crowdstrike. So I've got a gap of 100

574
00:36:02,950 --> 00:36:06,430
and I see that they're not running malware bytes or my secondary EDR.

575
00:36:06,510 --> 00:36:10,170
So these are the devices that I need to get on top of, because CrowdStrike

576
00:36:10,190 --> 00:36:13,570
knows about CrowdStrike. Tenable knows about tenable, phosphorus knows about phosphorus.

577
00:36:13,650 --> 00:36:16,086
But if you have a platform that can understand what they all know, you start

578
00:36:16,108 --> 00:36:19,194
to find the gaps. Further than that, they feed to make

579
00:36:19,232 --> 00:36:22,406
other tools better. So they have API Bi directional integration

580
00:36:22,438 --> 00:36:26,182
with solutions like CMDBs, ticketing systems, SIm soar

581
00:36:26,246 --> 00:36:29,926
so from remediation with cortex or splunk

582
00:36:29,958 --> 00:36:32,938
or Servicenow or Arcsight. Whatever tools you happen to be using,

583
00:36:33,104 --> 00:36:36,586
it's feeding them with the best possible data so those tools can be as accurate

584
00:36:36,618 --> 00:36:39,198
as they are. That's my whole sales pitch on that. I just want to make

585
00:36:39,204 --> 00:36:42,606
sure people are aware that there are solutions like this out there that can

586
00:36:42,628 --> 00:36:45,678
actually get in front of these types of attacks. And if

587
00:36:45,684 --> 00:36:48,674
you'd like to try out one of these solutions for free,

588
00:36:48,872 --> 00:36:52,338
you can poc the whole thing in 60 minutes or less. Less time than it

589
00:36:52,344 --> 00:36:55,650
took you to listen to me yap on. In these presentation

590
00:36:56,310 --> 00:36:59,778
you can get like three sources, one person for a

591
00:36:59,784 --> 00:37:02,966
point of contact in 1 hour. You can actually try this stuff out. If you

592
00:37:02,988 --> 00:37:06,242
like it, you can say hey, beyond devices, I want to add identities and apps

593
00:37:06,306 --> 00:37:09,186
now. I want to integrate with CMDB. You can certainly do that if you decide

594
00:37:09,218 --> 00:37:11,674
to move forward. But if you want to kick the tires in something again,

595
00:37:11,712 --> 00:37:15,094
it's free, because most people aren't familiar with these platforms. Here's a QR

596
00:37:15,142 --> 00:37:18,666
code, here's a URL, go check it out. So with

597
00:37:18,688 --> 00:37:21,942
that, thank you so much. I hope you enjoyed the presentation. I hope you enjoyed

598
00:37:22,006 --> 00:37:26,220
the hacking demos. As you can see, hacking in the XioT world

599
00:37:26,670 --> 00:37:30,326
isn't that complicated, just some very basic steps

600
00:37:30,358 --> 00:37:33,906
and maneuvering, especially if the already are discoverable on

601
00:37:33,928 --> 00:37:37,614
something like exploit DB where you can just grab those and use that Python

602
00:37:37,662 --> 00:37:40,914
script, or use Metasploit if you want to use Metasploit. In that case,

603
00:37:41,032 --> 00:37:44,654
and take advantage of these devices, there's a lot of them, they're all Linux

604
00:37:44,702 --> 00:37:48,942
servers, they're not managed, they typically don't have good passwords,

605
00:37:49,006 --> 00:37:52,626
they're typically running old firmware, and they typically have lots and lots of

606
00:37:52,648 --> 00:37:56,226
exploitable vulnerabilities. I hope you enjoyed the presentation. See you

607
00:37:56,248 --> 00:37:56,560
next time.

